----------- CONSULTAS PARA DW --------------
-- TABLA HECHOS_VENTAS:
SELECT FACT_PROPERTY.ID_PROPERTY, FACT_PROPERTY.ID_SUP, FACT_PROPERTY.ID_EMPLOYEE, FACT_PROPERTY.ID_CUST, CONVERT(DATE, FACT_DATE) tiempoId, 
PROPERTYS.PRICE Precio
FROM FACT_PROPERTY 
INNER JOIN PROPERTYS ON FACT_PROPERTY.ID_PROPERTY=PROPERTYS.ID_PROPERTY 
GROUP BY FACT_PROPERTY.ID_PROPERTY, FACT_PROPERTY.ID_SUP, FACT_PROPERTY.ID_EMPLOYEE, FACT_PROPERTY.ID_CUST, FACT_PROPERTY.FACT_DATE, PROPERTYS.PRICE;


-- TABLA D_CLIENTES
SELECT ID_CUST, NAME_CUST, NIF_CUST FROM CUSTOMER;


-- TABLA D_EMPLEADOS
SELECT ID_EMPLOYEE, CONCAT(FIRST_NAME, ' ', LAST_NAME) FROM EMPLOYEES;


-- TABLA D_PROPIEDADES
SELECT ID_PROPERTY, NIF_PROPERTY, PROPERTY_TYPE FROM PROPERTYS;


-- TABLA D_PROVEEDORES
SELECT ID_SUP, NAME_SUP, NIF_SUP FROM SUPPLIERS;


-- TABLA D_TIEMPO
SELECT CONVERT(DATE, FACT_DATE) tiempoID, DATEPART(YEAR, FACT_DATE) a√±o, 
DATEPART(MONTH, FACT_DATE) mes, DATEPART(WEEK, FACT_DATE) semana,
DATEPART(QUARTER, FACT_DATE) trimestre, (DATEPART(QUARTER, FACT_DATE)/3)+1 semestre, DATEPART(WEEKDAY, FACT_DATE) Dia_Semana
FROM FACT_PROPERTY
GROUP BY FACT_PROPERTY.FACT_DATE;